# CNN-Transformerλ¥Ό μ΄μ©ν• μ•”νΈν™”ν κ°€κ²© μμΈ΅ λ¨λΈ

## π“ ν”„λ΅μ νΈ κ°μ”
CNN-Transformer ν•μ΄λΈλ¦¬λ“ λ¨λΈμ„ μ‚¬μ©ν•μ—¬ μ•”νΈν™”ν κ°€κ²©μ„ μμΈ΅ν•λ” ν”„λ΅μ νΈμ…λ‹λ‹¤. ETH, ADA, XRP λ°μ΄ν„°λ΅ ν•™μµν•μ—¬ BTCμ κ³ κ°€/μ €κ°€λ¥Ό μμΈ΅ν•λ” μν™ ν•™μµ(Curriculum Learning) λ°©μ‹μ„ μ μ©ν–μµλ‹λ‹¤.

## π—οΈ λ¨λΈ κµ¬μ΅°
- **CNN**: 1D μ»¨λ³Όλ£¨μ…μΌλ΅ λ‹¨κΈ° ν¨ν„΄ μ¶”μ¶ (16β†’64 μ±„λ„)
- **Transformer**: λ©€ν‹°ν—¤λ“ μ–΄ν…μ…μΌλ΅ μ¥κΈ° μμ΅΄μ„± ν•™μµ (8ν—¤λ“, 3λ μ΄μ–΄)
- **μ…λ ¥**: (batch, 52, 16) β†’ **μ¶λ ¥**: (batch, 2) [κ³ κ°€, μ €κ°€]
- **νλΌλ―Έν„° μ**: μ•½ 633,922κ°

## π“ νμΌ κµ¬μ΅°

### **ν•µμ‹¬ νμΌ**
- `cnn_transformer_model.ipynb` - λ©”μΈ μ‹¤ν— λ…ΈνΈλ¶ (λ¨λΈ ν›λ ¨ λ° ν‰κ°€)
- `requirements.txt` - Python μμ΅΄μ„± λΌμ΄λΈλ¬λ¦¬ λ° λ²„μ „ μ •λ³΄
- `preprocess_rl.py` - μ•”νΈν™”ν λ°μ΄ν„° μ „μ²λ¦¬ μ¤ν¬λ¦½νΈ

### **λ°μ΄ν„° νμΌ**
- `preprocessed/` - μ „μ²λ¦¬λ μ•”νΈν™”ν λ°μ΄ν„° νμΌλ“¤
  - `ADA_1h.npy` - μΉ΄λ¥΄λ‹¤λ…Έ(ADA) 1μ‹κ°„ λ΄‰ λ°μ΄ν„°
  - `BTC_1h.npy` - λΉ„νΈμ½”μΈ(BTC) 1μ‹κ°„ λ΄‰ λ°μ΄ν„°
  - `ETH_1h.npy` - μ΄λ”λ¦¬μ›€(ETH) 1μ‹κ°„ λ΄‰ λ°μ΄ν„°
  - `XRP_1h.npy` - λ¦¬ν”(XRP) 1μ‹κ°„ λ΄‰ λ°μ΄ν„°

### **μƒμ„±λλ” νμΌ** (μ‹¤ν–‰ μ¤‘ μƒμ„±)
- `models/` - ν›λ ¨λ λ¨λΈ μ²΄ν¬ν¬μΈνΈ μ €μ¥ ν΄λ”
- `raw/` - μ›λ³Έ λ°μ΄ν„° ν΄λ” (ν•΄λ‹Ήμ‹)

## π”§ μ‹¤ν— ν™κ²½ μ„¤μ •

### **Python λ²„μ „**
- Python 3.10.0

### **λΌμ΄λΈλ¬λ¦¬ μ„¤μΉ**
```bash
pip install -r requirements.txt
```

### **μ£Όμ” μμ΅΄μ„±**
- torch==2.8.0.dev20250419+cu128 (CUDA μ§€μ› PyTorch)
- numpy==1.23.5
- pandas==2.2.3
- matplotlib==3.10.1
- stable_baselines3==2.6.0 (κ°•ν™”ν•™μµ μ»΄ν¬λ„νΈμ©)

## π€ μ‹¤ν–‰ λ°©λ²•

### **1. ν™κ²½ μ„¤μ •**
```bash
# μμ΅΄μ„± λΌμ΄λΈλ¬λ¦¬ μ„¤μΉ
pip install -r requirements.txt

# GPU μ‚¬μ© κ°€λ¥ μ—¬λ¶€ ν™•μΈ (μ„ νƒμ‚¬ν•­, κ¶μ¥)
python -c "import torch; print(f'CUDA μ‚¬μ© κ°€λ¥: {torch.cuda.is_available()}')"
```

### **2. μ‹¤ν— μ‹¤ν–‰**
Jupyter λ…ΈνΈλ¶μ„ μ—΄μ–΄μ„ μ‹¤ν–‰:
```bash
jupyter notebook cnn_transformer_model.ipynb
```

**μ¤‘μ”**: `Kernel β†’ Restart & Run All`μ„ μ‚¬μ©ν•μ—¬ μ „μ²΄ μ½”λ“κ°€ μ¤λ¥ μ—†μ΄ μ‹¤ν–‰λλ”μ§€ λ°λ“μ‹ ν™•μΈν•μ„Έμ”.

### **3. μμƒ μ‹¤ν–‰ μ‹κ°„**
- GPU ν™κ²½ (RTX 5070): μ•½ 30-60λ¶„
- CPU ν™κ²½: μ•½ 2-4μ‹κ°„ (κ¶μ¥ν•μ§€ μ•μ)

## π“ μ‹¤ν— μƒμ„Έ μ •λ³΄

### **ν›λ ¨ μ „λµ**
- **μν™ ν•™μµ**: ETH β†’ ADA β†’ XRP μμ°¨ ν›λ ¨ (3μ‚¬μ΄ν΄)
- **μ½”μΈλ³„ μ—ν¬ν¬**: 10 μ—ν¬ν¬
- **μ΄ ν›λ ¨ λ‹¨κ³„**: 90 μ—ν¬ν¬
- **λ°°μΉ ν¬κΈ°**: 128

### **λ°μ΄ν„° κµ¬μ„±**
- **ν›λ ¨ λ°μ΄ν„°**: ETH, ADA, XRP (3κ° μ•”νΈν™”ν)
- **ν…μ¤νΈ λ°μ΄ν„°**: BTC (λΉ„νΈμ½”μΈ)
- **μ‹ν€€μ¤ κΈΈμ΄**: 52 νƒ€μ„μ¤ν…
- **νΉμ§• μ**: 16κ° κΈ°μ μ§€ν‘ (κ°€κ²©, κ±°λλ‰, RSI, MACD λ“±)

### **λ¨λΈ ν›λ ¨ μ„¤μ •**
- **μµν‹°λ§μ΄μ €**: Adam (ν•™μµλ¥ =0.001, weight_decay=1e-5)
- **μ†μ‹¤ ν•¨μ**: MSE (ν‰κ·  μ κ³± μ¤μ°¨)
- **μ¤μΌ€μ¤„λ¬**: ReduceLROnPlateau (patience=3, factor=0.5)

## π“ μμƒ κ²°κ³Ό

### **ν›λ ¨ κ³Όμ •**
- μ‚¬μ΄ν΄λ³„ μ μ§„μ  μ†μ‹¤ κ°μ†
- 4κ° μ„λΈν”λ΅―μΌλ΅ κµ¬μ„±λ ν›λ ¨ μ‹κ°ν™”:
  - μ½”μΈλ³„ ν›λ ¨ μ†μ‹¤ λ³€ν™”
  - μ‚¬μ΄ν΄λ³„ ν…μ¤νΈ μ†μ‹¤ λ³€ν™”
  - μ½”μΈλ³„ μµμΆ… ν›λ ¨ μ†μ‹¤ λΉ„κµ
  - μ „μ²΄ ν›λ ¨ κ³Όμ • μ”μ•½

### **μμΈ΅ μ„±λ¥ λ¶„μ„**
- μ‹κ³„μ—΄ λΉ„κµ: μ‹¤μ κ°’ vs μμΈ΅κ°’ (κ³ κ°€/μ €κ°€)
- μ„±λ¥ μ§€ν‘: MSE, MAE, λ°©ν–¥μ„± μ •ν™•λ„
- μµκ·Ό 500κ° λ°μ΄ν„° ν¬μΈνΈ μ‹κ°ν™”

## β οΈ μ£Όμμ‚¬ν•­

### **ν•λ“μ›¨μ–΄ μ”κµ¬μ‚¬ν•­**
- **κ¶μ¥**: CUDA νΈν™ GPU (8GB+ VRAM)
- **μµμ†**: CPU ν›λ ¨μ© 16GB RAM

### **νμΌ μμ΅΄μ„±**
- `preprocessed/` ν΄λ”μ— λ¨λ“  μ „μ²λ¦¬λ λ°μ΄ν„° νμΌμ΄ μμ–΄μ•Ό ν•¨
- λ¨λΈμ€ μ²΄ν¬ν¬μΈνΈ μ €μ¥μ„ μ„ν•΄ `models/` ν΄λ”λ¥Ό μλ™ μƒμ„±

### **μ¤λ¥ λ°©μ§€**
- μ‹¤ν–‰ μ „ λ¨λ“  νμΌμ΄ μ¬λ°”λ¥Έ λ””λ ‰ν† λ¦¬μ— μλ”μ§€ ν™•μΈ
- `Restart & Run All`λ΅ μ „μ²΄ μ‹¤ν–‰ κ°€λ¥ μ—¬λ¶€ κ²€μ¦
- GPU ν›λ ¨ μ‹ CUDA μ‚¬μ© κ°€λ¥ μ—¬λ¶€ ν™•μΈ

## π― μ¬ν„ κ°€λ¥μ„±

μ΄ μ €μ¥μ†λ” μ™„μ „ν• μ¬ν„μ΄ κ°€λ¥ν•λ„λ΅ μ„¤κ³„λμ—μµλ‹λ‹¤:
1. μ €μ¥μ† λ‹¤μ΄λ΅λ“ λ° μ••μ¶• ν•΄μ 
2. λΌμ΄λΈλ¬λ¦¬ μ„¤μΉ: `pip install -r requirements.txt`
3. λ…ΈνΈλ¶ μ‹¤ν–‰: `jupyter notebook cnn_transformer_model.ipynb`
4. μ „μ²΄ μ‹¤ν–‰: `Kernel β†’ Restart & Run All`

λ¨λ“  μ‹¤ν—μ€ μ¤λ¥ μ—†μ΄ μ™„λ£λλ©° μΌκ΄€λ κ²°κ³Όλ¥Ό μ‚°μ¶ν•©λ‹λ‹¤.

## π“ λ°μ΄ν„° μ¶μ²
- κ³µκ° APIλ¥Ό ν†µν•΄ μμ§‘λ μ•”νΈν™”ν κ°€κ²© λ°μ΄ν„°
- ν‘μ¤€ κΈμµ λΌμ΄λΈλ¬λ¦¬λ¥Ό μ‚¬μ©ν• κΈ°μ μ§€ν‘ κ³„μ‚°
- μ •κ·ν™” λ° νΉμ§• κ³µν•™μ„ ν¬ν•¨ν• λ°μ΄ν„° μ „μ²λ¦¬ 